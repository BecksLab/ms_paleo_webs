---
title: "Methods for Reconstructing Paleo Food Webs"
author:
  - name: Tanya Strydom
    id: ts
    orcid: 0000-0001-6067-1349
    corresponding: true
    email: t.strydom@sheffield.ac.uk
    role: 
    - conceptualization: lead
    - methodology: lead
    affiliation:
      - id: sheffield
        name: School of Biosciences, University of Sheffield, Sheffield, UK
  - name: Baran Karapunar
    id: bk
    orcid: 0000-0001-9711-1492
    corresponding: false
    role: 
    - conceptualization: lead
    - methodology: supporting
    affiliation:
      - id: leeds
        name: School of Earth and Environment, University of Leeds, Leeds, UK
  - name: Andrew P. Beckerman
    id: apb
    orcid: 0000-0002-7859-8394
    corresponding: false
    role: 
    - conceptualization: lead
    - methodology: supporting
    affiliations:
      - ref: sheffield
  - name: Alexander Dunhill
    id: ad
    orcid: 0000-0002-8680-9163
    corresponding: false
    role: 
    - conceptualization: lead
    - methodology: supporting
    affiliations:
      - ref: leeds
funding: "The author(s) received no specific funding for this work. Well they did I just haven't done the homework"
keywords:
  - food web
  - network construction
abstract: |
  Food webs represent the feeding relationships between species and can help infer ecosystem-level processes. Alongside the development of food web theory, methods for constructing food webs have been developed to infer species interactions when empirical data is lacking. Food web construction methods are diverse, each utilising different approaches to infer species interactions —such as the use of traits to infer mechanistic relationships vs using gut content as a proxy for species diets. These methods have distinct theories, mechanisms, and data requirements. In paleoecology, where direct evidence of feeding interactions are rare, food web construction methods are especially valuable and affords us the opportunity to make inferences about paleo communities beyond simply a record of species composition. However, the limitations of paleontological data (e.g., information of species traits is limited to that which can be preserved) restrict which methods can reliably be used. By considering both ecological theory and the constraints of what can be derived from the fossil record, we identify the methods best suited for the construction of paleo food webs. Specifically, we focus on how these methods differ in the networks they produce and what these networks can reveal about species interactions. In doing so we hope to clarify the ecological nuances of network prediction and help prevent the accidental misuse or misinterpretation of paleo food webs.
date: last-modified
bibliography: references.bib
citation:
  container-title: TBD
number-sections: true
---

There has been a growing interest in understanding community responses to environmental changes across deep time events as a means to help understand current and future biodiversity changes [@kiessling2019; @dillon2022]. Species interactions and the resulting networks have gained popularity in contemporary settings as a means to help us to understand aspects of community composition and biodiversity (eg @thuiller2024 and ??) and so it is perhaps unsurprising that there has been a growing interest in using paleo food webs in a similar manner [*e.g.,* @dunhill2024 looked at...; @hao2025 looked at...; @yeakel2014 looked at...]. However, one of the core challenges and limitations of being able to effectively *use* food webs is the challenge of *creating* them [@jordano2016], although this is a challenge within contemporary settings it is compounded in paleo contexts where, in the absence of being able to observe interactions, we are dependent on the fossil record (and the inherent limitation it imposes) to infer interactions. As a way to address the challenges with recording species interactions there has been the development of a large number of models and tools that can be used to infer either species interactions [see *e.g.,* @morales-castilla2015; @pichler2023; @strydom2021 for broader reviews] or networks [see *e.g.,* @allesina2008]. Although there has been the development of models and tools that are specific for inferring paleo food webs [*e.g.,* @shaw2024; @roopnarine2006; @fricke2022], it should be noted that these models only occupy a subset of the broader family of approaches that are used to predict networks, as they typically only focus on assessing the feasibility of interactions between species. Being able to construct only one 'type' of network means that we are limited in the scope of questions that we can appropriately answer with those networks [see Strydom in prep; @gauzens2025]. However, there is scope that models and tools that have been developed in contemporary settings have the potential to be used for paleo settings [*e.g.,* @yeakel2014], which opens the door for researchers to ask a broader and more complete range of questions about community responses to environmental change.

Here we aim to provide an overview of the different models that can be used to construct food webs using paleo data. Specifically we focus on identifying a suite of models that are appropriate for use with paleo data that can feasibly be constructed within the limitations that are imposed by fossil data while still spanning the larger network space. Additionally we use the data from @dunhill2024 as a case study to understand how different models recover different networks, both in terms of structure as well as pairwise interactions and establish if there are consequences for using networks that are constructed using different models in terms of making inferences about the behaviour of the system by looking at how the model type influences what we infer to be the dominant driver of extinctions across a mass extinction event.

# Constructing paleo webs

# Challenges specific to building paleo networks

Although there has been a push for the development of tools and methods that allow us to predict species interactions and networks they will not all be suitable for the prediction of paleo communities. This is primarily due to limitations that we are faced with in terms of the information that can be inferred from the fossil record (such as species traits, abundances, and assemblages), which is needed as input data for the different models. The limited information available from the fossil record is compounded by the incomplete and biased preservation of species \[REF\], which part of a species is preserved (part vs whole), the ambiguity of the 'true' community composition \[were communities conserved *in situ* or were they there owing to geological processes?; REF\], as well as the availability/accessibility of different rock layers (and thus the completeness of data we might have for a specific era in time). Additionally there is an increasing degree of 'fuzziness' around the ecology and life histories of species the further one moves back in geological time \[REF\]. This is not to say that because we have imperfect data we should not be attempting to construct paleo food webs but rather that we need to be aware of what the uncertainties are and how these might impact the assumptions that we need to make when constructing a network (as well as how this will intersect with the intended end use of the network). This will allow us to best identify an approach that minimises the assumption and potential uncertainties within the data while still constructing a suitable network. This includes thinking about both assumptions you are making about the actual data *e.g.,* trying to extrapolate body size from fossil data but also assumptions across time *e.g.,* assuming modern trait-feeding modes are the same or that assumptions about network structure will hold across deep time.

## Understanding the approaches to network construction

Broadly we can think about network construction as being nested within two different schools of thought (and thus methodological approaches, @fig-concept), models that focus on assessing the *mechanistic* feasibility of an interaction being able to occur between two species or models that are more closely married to specific bodies of ecological *theory* - such as niche theory or foraging ecology. The former of which will construct 'metawebs' and the latter 'realised networks' [Strydom et al in prep]. Models that have specifically been developed in the paleo space tend to be mechanistic in nature in that they focus on using a trait-based approach to formalise feeding interactions (*e.g.,* @shaw2024; @roopnarine2006), are assembled by expert opinion (*e.g.* @dunne2014), or make assumptions based on the evolutionary signals of interactions (*e.g.,* @fricke2022). Thus paleo models typically only construct metawebs, and there is the need for the intentional adoption of theoretical models if we want to realise the full potential of questions and information that we can glean from the fossil record. However, there is an argument that the fundamental 'currencies of life' to have remained constant - *e.g.,* the energetic constraints of foraging or foraging niches, meaning that theoretical models that have been developed and tested on contemporary food webs should still hold for paleo communities.

![This obviously needs work but a variation on this to try and articulate the different approaches and broadly how they may differ.](figures/model_fams.png){#fig-concept}

Here we present six different models (@tbl-models) that can be used to construct food webs for both this specific community but are also broadly suited to paleo network prediction. These models span all facets of the network representation space (metaweb, realised, and structural network) and are suitable for an array of different paleo communities as the data requirements fall within the limitations set by the fossil record.

| Model family | Assumptions | Data needs | 'Limitation' | Network type | Key reference |
|------------|------------|------------|------------|------------|------------|
| random | Links are randomly distributed within a network | richness, number of links | parameter assumptions, species agnostic | structural network | @erdos1959 |
| niche | Networks are interval, species can be ordered on a 'niche axis' | richness, connectance | parameter assumptions, species agnostic | structural network | @williams2008 |
| allometric diet breadth model (ADBM) | Interactions are determined by energetic costs (foraging ecology) | body mass, biomass (abundance) | does not account for forbidden links in terms of trait compatibility, assumptions on body size and biomass (abundance) from fossil data | theoretical network | @petchey2008 |
| l-matrix | Interactions inferred using allometric rules (ratio of body sizes between predator and prey), with links being constrained by a Ricker function | body mass, number of producer species | does not account for forbidden links in terms of trait compatibility, assumptions on body size from fossil data, assumptions as to the number of producer species | theoretical network | @schneider2016 |
| paleo food web inference model (PFIM) | Interactions can be inferred by a mechanistic framework/relationships | feeding traits for taxa, mechanistic feeding rules | Assumption made as to the feeding mechanisms, need to elucidate traits from models (although this is a way smaller issue) | mechanistic web | @shaw2024 |
| body size ratio model | Interactions inferred using allometric rules (ratio of body sizes between predator and prey). Logit of the linking probability used to further constrain links to an 'optimal size range' for prey. | body mass | does not account for forbidden links in terms of evolutionary compatibility, assumptions on body size from fossil data | theoretical network | @rohr2010 |

: A summary of the different families of tools that can be used to generate paleo food webs. {#tbl-models}

# Case study: Toarcian mass extinction event

## Dataset overview

### Species occurrence

Here we use the fossil occurrence data over an interval extends from the upper Pliensbachian (\~185 Ma) to the upper Toarcian (\~175 Ma) of the Cleveland Basin [see @dunhill2024 for a more comprehensive overview]. The data set consists of a subset of four broad time periods (pre-extinction, post-extinction, early recovery, and late recovery). The assemblages are treated as communities of interacting organisms. Something about the total number of taxa as well as numbers per a time period? Probbaly also make a comment that this is a 'deep time' community we are looking at.

### Defining modes of life (traits)

We used the modes of life (traits) as identified in @dunhill2024, who defined four traits: motility (fast, slow, facultative, non-motile), tiering (pelagic, erect, surficial, semi-infaunal, shallow infaunal, deep infaunal), feeding (predator, suspension feeder, deposit feeder, mining, grazer), and size: gigantic (\>500 mm), very large (\>300–500 mm), large (\>100–300 mm), medium (\>50–100 mm), small (\>10–50 mm), tiny (≤10 mm), for each fossil species based on the ecological traits defined in the Bambach ecospace model [@bambach2007].

### Constructing networks

For each paleo community (time bin) we constructed **100** networks for each model (so 6 \* 100) networks. These networks were simplified so as to remove any disconnected species. In total 2 400 networks were constructed. When a quantitative measure of body size is needed (ADBM, body size ratio, and l-matrix) we drew a body mass for each species from a uniform distribution, with ranges being defined by the different size classes *e.g.,* a species classed as 'very large' would have a body mass drawn from $U(300, 500)$. This was repeated for each run in order to add variation to the networks constructed, however the same body sizes were kept consistent for the relevant models *i.e.,* an ADBM and l-matrix network from the same replicate have the same bodysizes. For both the random and niche model the desired connectance was randomly selected between the range 0.07 - 0.15 for each replicate but kept consistent for both models. For each network we calculated the properties listed in @tbl-properties

## Models capture different network structure but in unexpected ways

Broadly when we talk about quantifying the structure of a network we are interesting in capturing some aspect of how the links are distributed between nodes, or alternatively about properties of the nodes. Structure is useful as it is gives information as to how the interactions between species are distributed within the community, informing us on *e.g.,* energy flows and fluxes \[REF\], propagation of stress \[REF\], and something about trophic levels \[REF\]. We are also able to glean information on interaction strategies between smaller interacting units in the bigger community in the form of motifs [@milo2002; @stouffer2007]. Motifs allow us to identify *e.g.,* the prevalence of competition, as well as smaller chains within the network. Node-level properties look at the the number of links coming in to (prey) or out of (predators) a node and are informative of diet specialisation.

| Metric | Definition | Scale | Reference (for maths), can make footnotes probs |
|------------------|-------------------|------------------|------------------|
| Richness | Number of nodes in the network | Macro |  |
| Links | Normalized standard deviation of links (number of consumers plus resources per taxon) | Micro |  |
| Connectance | $L/S^2$, where $S$ is the number of species and $L$ the number of links | Macro |  |
| Max trophic level | Prey-weighted trophic level averaged across taxa | Macro | @williams2004 |
| Diameter | Diameter can also be measured as the average of the distances between each pair of nodes in the network | Macro | @delmas2018 |
| Complexity | SVD complexity of a network, defined as the Pielou entropy of its singular values | Macro | @strydom2021 |
| Redundancy | $(L - (S - 1))/S$, where $S$ is the number of species and $L$ the number of links. Indicates the number of edges beyond what is needed for a minimum-connected tree | Macro |  |
| S1 | Number of linear chains, normalised | Meso | @milo2002; @stouffer2007 |
| S2 | Number of omnivory motifs, normalised | Meso | @milo2002; @stouffer2007 |
| S4 | Number of apparent competition motifs, normalised | Meso | @milo2002; @stouffer2007 |
| S5 | Number of direct competition motifs, normalised | Meso | @milo2002; @stouffer2007 |
| Generality | Normalized standard deviation of generality of a species standardized by $L/S$ | Micro | @williams2000 |
| Vulnerability | Normalized standard deviation of vulnerability of a species standardized by $L/S$ | Micro | @williams2000 |

: Network properties used fo analysis. {#tbl-properties}

In terms of wanting to asses and compare across the different models it is beneficial to approach this task by thinking about the different aspects of the network as well as interactions that are being predicted by the different models across different 'scales' of organisation within the network, namely macro (the entire network), meso (smaller interacting units within the network), and micro (species-level attributes). Although there are a myriad of possible ways to 'measure' and analyse ecological networks [@delmas2018] we have selected those outlined in @tbl-properties as they span different scales within thr network and have been shown to be informative of different ecological processes.

Here we used a Multivariate Analysis Of Variance (MANOVA) to assess the differences between networks generated by different models based on the combined information of the multiple structural network measures. Model defined as `network structure values ~ model + time period` additionally we used a Linear Discriminant Analysis (LDA) to determine if different models produced networks with differing structure. In order to do the MANOVA and LDA we had to create within model variation for the different networks, with the exception of the PFIM model all models have some inherent variation. In order to generate variation within the PFIM metawebs we applied a *minimal* degree of downsampling following the protocol described in @roopnarine2017. This downsampling approach uses a power law distribution to essentially 'prune' links from the most generalist species (See SUPP MATT for a more detailed overview).

**Need to report the relevant effect of time in driving observed differences???**

![Linear Discriminant Analysis using thirteen different metrics of network structure. The colours represent the different models. The black points represent the predicted metaweb co-ordinates for the four different time periods.](figures/MANOVA_lda.png){#fig-structure}

> should I report some more 'quantitative results' i.e. a summary table...

What is perhaps the most striking result in @fig-structure is that although there are clear structural differences between the different models the differences are not distinct between the broader model families but rather that there is a degree of overlap between them (specifically the body size ratio, PFIM, and niche models). Although the log ratio and niche models are classified as different families they are built on similar ecological background and theory and so it is perhaps not surprising that these networks capture a similar structure (the same holds for the ADBM and l-matrix models). The fact that the random model occupies a completely different space is unsurprising as it has clearly been shown that networks are non-random in nature \[REF\] and so we expect random models to be constructing 'ecologically illogical' networks. What is perhaps the most interesting result is that the PFIM model constructs networks that are very similar to those that are rooted in niche-based processes despite the model being more mechanistic in nature. (Not sure how to articulate but this is cool because there is *something* in network structure constraints that is straddling the trait-niche space of ecology)

Although it is not possible to confidently identify the models that are predicting the *'correct'* network structure the fact that models from different families are able to recover similar structures is reassuring as it suggests that it might be possible to substitute one model for another if the required data are not available. Although it is still important that an effort is made to match the 'best' model/network to the question being asked.

> It would be remiss to not think about the fact that niche models are supposed to work with trophic species not taxonomic species - I wonder if we should run the niche (and possibly random) models with trophic species as the starting richness and not the taxo richness...

## Some networks don’t share any interactions and some share a lot

In addition to wanting to measure network structure researchers may also be interested in understanding aspects about the diets and predators of *specific* species in a community. In this instance the interest should be in understanding how the pairwise links predicted between species pairs differ between models. Here we look at the interaction turnover both within and between the different models [@poisot2012]. This can be thought of as the equivalent of species $\beta$ turnover and tells us which interactions are 'conserved' (shared) across the networks but only between species pairs that are shared - *i.e.,* this turnover is only driven by interaction and not species turnover. Here we only compared networks that we constructed for the same period (as our interest is only in between model differences) and excluded the random and niche networks from consideration as these two models are essentially species agnostic.

![% interaction shared is calculated as number shared interactions / ((number interactions left - shared interactions) + (number interactions right - shared interactions) + shared interactions). Additionally niche and random models are excluded as it is illogical since both of these models are fundamentally species agnostic](figures/beta_div.png){#fig-beta_div}

In @fig-beta_div it is clear that some models share a large percentage of interactions *e.g.,* between ADBM and l-matrix networks and others share nothing *e.g.,* ADBM and PFIM networks. This result is unsurprising as the mechanisms that determine interactions in ADBM and l-matrix (a single trait (bodysize) + paramterisiation of links by ecological theory) is very different from the PFIM model that makes assumptions on a trait-based, mechanistic hierarchy.

The key takeaway that this needs to lead into is thinking about diet related questions and the model that is best suited to get you there. It makes sense to contextualise this in the feasible vs realised interaction spectrum - specifically that from a 'philosophical' basis if you are asking questions about possible diets of species then it makes sense to use models that fall firmly in the 'feasible' space *e.g.,* PFIM model or even something like the @fricke2022 model. How these results support that is that we can see the ADBM and PFIM are recovering (almost) totally different pairwise links and on a conceptual basis it means that we cannot use something like the ADBM to ask questions about diet breadth (note here this makes the assumption that something like the PFIM is truly aligning with diet breadth, which I am inclined to say it is).

## Model choice changes the narrative

#### Simulating Extinctions

Extinctions were simulated using different plausible mechanisms based on species traits (size, motility), their position within the network (generality, vulnerability), as well as randomly. Each network was subjected to **50** extinction runs for each extinction mechanism. The extinctions themselves were cascading in nature meaning that after the target species was removed all species that no longer had any prey were also deemed as extinct (secondary extinction), checking for secondary extinctions was then repeated until there were no longer any species without prey. This represents one extinction event and only then would the proceeding target species be removed from the network and cascading extinctions assessed again. Note that for extinction simulations which use the network position of a species to determine extinction order we follow the protocol from @curtsdotter2011 and reassess the vulnerability/generality of each species after each extinction event to 'redetermine' the extinction order based on their position in the newly generated network.

As we are using @dunhill2024 as a case study we followed their approach when simulating extinctions as well as assessing which extinction mechanism results in a simulated network that most closely matches the real post extinction network. Extinction simulations were only run on the pre extinction networks whereby species were removed until they reached the 'target richness', which is the richness of the post extinction community. **TODO** The whole shebang about the different extinction simulation scenarios.

> **TODO** not sure if we also want to unpack/showcase robustness $R_{50}$ [@jonsson2015]

![stuff... Recreation of the figure from Dunhill 2024. I think it makes sense to split and divide into the below sections (depending on potential figure limitations of target journal)](figures/dunhill_comp.png){#fig-dunhill}

### Trends over time

> **TODO** Not sure statistically speaking what the best way to unpack this is... 2-way ANOVA/ANCOVA explanation is valuable? There are intercept differences (*e.g.,* baseline average values are different; are the rankings among all three response variables the same?) and there are shape differences/similarities (*e.g.,* motifs are all the same shape but Co and Gen show some among model differences in pattern.)

Visual take-away seems to suggest that we see that the values (intercepts) of the different summary statistics are different but (broadly) they are capturing the same trends. This might suggest that although we observe differences in structure (@fig-structure) the general patterns still remain the same. This is good news because it means that at least the models that we have used here tend to tell us the same general story - which is worth contextualising in the space of 'right' vs 'wrong' and as long as we are not fixated on the point value but rather on understanding the trends.

### Inferred extinction drivers

In order to determine which extinction mechanism creates a network most similar to the post extinction network we use a derivative of the true skill statistic from @gupta2022. Here we calculated both a node-level TSS as well as link-level TSS, by parsing out the TSS into two ocmponents we are able to assess if differences between real and simulated networks are due to node-level (the wrong species being removed) or link-level (the wrong links be recovered) differences. 

Points of discussion one will be to point to the mean absolute distance and how generally the ADBM/l-matrix do really badly - high mean absolute value. And this maybe makes sense though because of how we specify extinction mechanisms (trait-based) and so it sets the body-size models are not 'talking' the same language. In terms of the TSS scores - not sure how we should unpack it. Individually by model family to see which model agrees with which appraoch and see if different mechanisms come out stronger?

# Discussion (need a catchier heading)

I want this section to be more about contextualising model choice within the bigger research question discussion - i.e. mapping question and model choice more tightly...

Points to discuss:

-   Guidlines - as a box? Can we give something concrete?? Something like @fig-guidelines
-   How to we synthesise these results? As in should we give clear directives ot is it enough to do a bit more handwaving and have the bigger message be that model choice matters?

![TODO.](figures/guidelines.png){#fig-guidelines}

# References {.unnumbered}